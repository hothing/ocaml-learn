# Изучаем OCaml решая школьные заадачки по программированию

## Задача 1 "Пятью пять - двадцать пять!"

Вася и Петя учатся в школе в одном классе. Недавно Петя поведал Васе о
хитром способе возведения в  квадрат натуральных чисел, оканчивающихся
на  цифру  5.  Теперь  Вася  может с  легкостью  возводить  в  квадрат
двузначные  (и даже  некоторые трехзначные)  числа, оканчивающиеся  на
5. Способ  заключается в  следующем: для  возведения в  квадрат числа,
оканчивающегося  на   5  достаточно  умножить  число,   полученное  из
исходного  вычеркиванием последней  пятерки  на  следующее по  порядку
число, затем  остается лишь приписать «25»  к получившемуся результату
справа.  Например,  для  того,  чтобы возвести  число  125  в  квадрат
достаточно 12 умножить  на 13 и приписать 25, т.е.  приписывая к числу
12*13=156      число      25,      получаем      результат      15625,
т.е. 1252=15625. Напишите  программу, возводящую число, оканчивающееся
на 5, в квадрат для того, чтобы Вася смог проверить свои навыки.

### Решение
```ocaml
let check_last_digit x n =
    if n <= 9 then (x - n) mod 10 = 0 else false;;
let reduce_one_digit x = x / 10;;
let magic_square x =
    let y = reduce_one_digit x in
       if check_last_digit x 5 then (y * (y + 1))*100 + 25 else 0;;
```

## Задача 2

В свободное время  одноклассники Вася и Петя любят  играть в различные
логические игры: морской бой, крестики-нолики, шахматы, шашки и многое
другое. Ребята уже испробовали и поиграли во всевозможные классические
игры  подобного  рода,  включая компьютерные.  

Однажды  им   захотелось  сыграть  во  что-нибудь   новое,  но  ничего
подходящего  найти не  удалось.   Тогда Петя  придумал следующую  игру
«Угадайка»:   Играют  двое   участников.    Первый  загадывает   любое
трехзначное число, такое что первая  и последняя цифры отличаются друг
от  друга  более  чем  на   единицу.   Далее  загадавший  число  игрок
переворачивает  загаданное  число,  меняя  первую  и  последнюю  цифры
местами, таким образом получая еще одно число.  Затем из максимального
из  полученных  двух  чисел вычитается  минимальное.   Задача  второго
игрока –  угадать по первой  цифре полученного в  результате вычитания
числа  само это  число.  Например,  если  Вася загадал  число 487,  то
перестановкой первой  и последней  цифры он  получит число  784. После
чего  ему  придется  вычесть  из  784 число  487,  в  результате  чего
получится  число 297,  которое  и должен  отгадать  Петя по  указанной
первой цифре «2», взятой из этого числа.

Петя  успевает лучше  Васи по  математике, поэтому  практически всегда
выигрывает в  играх такого  типа. Но  в данном  случае Петя  схитрил и
специально придумал такую игру, в которой он не проиграет Васе в любом
случае.   Дело в  том,  что придуманная  Петей  игра имеет  выигрышную
стратегию,  которая  заключается  в следующем:  искомое  число  всегда
является трехзначным  и вторая  его цифра всегда  равна девяти,  а для
получения  значения  последней  достаточно отнять  от  девяти  первую,
т.е. в рассмотренном выше случае последняя цифра равна 9-2=7. Помогите
Пете еще  упростить процесс отгадывания  числа по заданной  его первой
цифре, написав соответствующую программу.

### Решение
```ocaml
let rec pow10 n = if n >= 1 then 10 * pow10 (n - 1) else 1;;
  
let lead_digits_at x n = if n >= 0 then x / (pow10 n) else 0;;
let tail_digits_at x n = if n > 0 then x mod (pow10 n) else 0;; 

let digit_at x n = tail_digits_at (lead_digits_at x n) 1;;

assert((digit_at 1234 0) = 4);;
assert((digit_at 1234 1) = 3);;
assert((digit_at 1234 2) = 2);;
assert((digit_at 1234 3) = 1);;
assert((digit_at 1234 4) = 0);;

let check_3digits x =
  let 
      fd = digit_at x 2
    and
      ld = digit_at x 0
  in ((fd - ld) > 1) || ((ld - fd) > 1);;

let reverse_3digits x =
  let y = tail_digits_at x 3
    and
      fd = digit_at x 2
    and
      md = digit_at x 1
    and
      ld = digit_at x 0
  in ld * (pow10 2) + md * (pow10 1) + fd * (pow10 0);;
  
    
  assert((reverse_3digits 123) = 321);;
  assert((check_3digits 123));;
    
    
    (* Direct task *)

  let emax x y = if x > y then x else y;;
  let emin x y = if x < y then x else y;;
    
  let encode x =
    let y = tail_digits_at x 2
    in if check_3digits y then
         let mx = emax (reverse_3digits y) y
           and
             nx = emin (reverse_3digits y) y
         in mx - nx
       else 0;;

    (* Inverse task *)

  let decode x =
    let 
      fd = digit_at x 0
    in if x <= 9 then
         fd * (pow10 2) + 9 * (pow10 1) + (9 - fd) * (pow10 0)
    else 0;;
```

## Задача 3
### Решение
```ocaml
```
